<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Dashboard - SmartAttend</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="../assets/css/style.css">
    <link rel="stylesheet" href="../assets/css/student-dashboard.css">
    <link rel="stylesheet" href="../assets/css/timetable-calendar.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>

    <!-- Top Navigation Bar -->
    <nav class="top-navbar">
        <div class="navbar-container">
            <!-- Logo -->
            <a class="navbar-brand" href="#">
                <div class="brand-icon">
                    <i class="bi bi-mortarboard-fill"></i>
                </div>
                <span class="brand-text">SmartAttend</span>
            </a>

            <!-- Navigation Menu -->
            <div class="navbar-menu">
                <a class="nav-item active" data-section="dashboard-section"
                    onclick="navigateToSection('dashboard-section', this)">
                    <i class="bi bi-grid-3x3-gap"></i> Dashboard
                </a>
                <a class="nav-item" data-section="timetable-section"
                    onclick="navigateToSection('timetable-section', this)">
                    <i class="bi bi-calendar3"></i> Timetable
                </a>
                <a class="nav-item" data-section="reports-section" onclick="navigateToSection('reports-section', this)">
                    <i class="bi bi-bar-chart"></i> Reports
                </a>
                <a class="nav-item" data-section="notices-section" onclick="navigateToSection('notices-section', this)">
                    <i class="bi bi-megaphone"></i> Notices
                    <span class="nav-badge" id="noticesBadge">2</span>
                </a>
            </div>

            <!-- Right Side Actions -->
            <div class="navbar-actions">
                <button class="icon-button" title="Settings" onclick="navigateToSection('profile-section')">
                    <i class="bi bi-gear"></i>
                </button>
                <div class="dropdown">
                    <button class="icon-button" title="Notifications" type="button" data-bs-toggle="dropdown">
                        <i class="bi bi-bell"></i>
                        <span class="notification-badge" id="notifBadge">0</span>
                    </button>
                    <div class="dropdown-menu dropdown-menu-end p-3"
                        style="width: 320px; max-height: 400px; overflow-y: auto;">
                        <h6 class="dropdown-header px-0 fw-bold">Notifications</h6>
                        <div id="notifList">
                            <div class="text-center text-muted py-3">
                                <i class="bi bi-bell-slash fs-4 d-block mb-2"></i>
                                No new notifications
                            </div>
                        </div>
                        <hr class="my-2">
                        <a class="dropdown-item text-center text-primary small" href="#"
                            onclick="clearNotifications()">Clear All</a>
                    </div>
                </div>
                <div class="dropdown">
                    <button class="profile-button" type="button" data-bs-toggle="dropdown">
                        <img id="navProfileImage"
                            src="https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?auto=format&fit=crop&w=100&q=80"
                            alt="Profile" class="profile-image">
                    </button>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li><a class="dropdown-item" href="#"
                                onclick="navigateToSection('profile-section'); return false;"><i
                                    class="bi bi-person me-2"></i>Profile</a></li>
                        <li>
                            <hr class="dropdown-divider">
                        </li>
                        <li><a class="dropdown-item text-danger" href="#" onclick="handleLogout(event)"><i
                                    class="bi bi-box-arrow-right me-2"></i>Logout</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="main-container">
        <div class="content-wrapper">

            <!-- Dashboard Section -->
            <div id="dashboard-section" class="page-section active">

                <!-- Greeting -->
                <div class="greeting-section">
                    <h1 class="greeting-title">Hello, <span class="highlight" id="studentName">Student</span> ðŸ‘‹</h1>
                    <p class="greeting-subtitle" id="currentDateDisplay">How is your attendance today?</p>
                </div>

                <!-- Low Attendance Banner -->
                <div id="lowAttendanceBanner" class="alert-banner d-none">
                    <div class="alert-content">
                        <div class="alert-icon">
                            <i class="bi bi-exclamation-triangle"></i>
                        </div>
                        <div class="alert-text">
                            <h4>Low Attendance Warning</h4>
                            <p id="lowAttendanceText">You have low attendance in one or more subjects.</p>
                        </div>
                    </div>
                    <button class="alert-action" onclick="navigateToSection('reports-section')">View Reports</button>
                </div>

                <!-- Dashboard Grid -->
                <div class="dashboard-grid">

                    <!-- Left Column -->
                    <div class="left-column">

                        <!-- Illustration with floating stats -->
                        <div class="illustration-card">
                            <div class="illustration-wrapper">
                                <!-- Brain/Study Illustration SVG -->
                                <svg class="brain-svg" viewBox="0 0 200 200">
                                    <defs>
                                        <linearGradient id="brainGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                                            <stop offset="0%" style="stop-color:#8B7FD8;stop-opacity:1" />
                                            <stop offset="100%" style="stop-color:#B8A4FF;stop-opacity:1" />
                                        </linearGradient>
                                    </defs>
                                    <circle cx="100" cy="100" r="80" fill="url(#brainGrad)" opacity="0.2" />
                                    <circle cx="100" cy="100" r="60" fill="url(#brainGrad)" opacity="0.3" />
                                    <path d="M 100 40 Q 60 60 70 100 T 100 160 Q 140 140 130 100 T 100 40"
                                        fill="url(#brainGrad)" opacity="0.8" />
                                    <circle cx="80" cy="80" r="15" fill="#fff" opacity="0.3" />
                                    <circle cx="120" cy="120" r="10" fill="#fff" opacity="0.2" />
                                </svg>

                                <!-- Floating stat cards -->
                                <div class="floating-stat top-right">
                                    <div class="floating-stat-label">Today's Classes <i
                                            class="bi bi-calendar-check"></i></div>
                                    <div class="floating-stat-status">Status: Active</div>
                                    <div class="floating-stat-value" id="todayAttendance">0/0</div>
                                </div>

                                <div class="floating-stat bottom-right">
                                    <div class="floating-stat-label">Monthly <i class="bi bi-graph-up"></i></div>
                                    <div class="floating-stat-status">Status: Standard</div>
                                    <div class="floating-stat-value" id="monthlyAttendance">0<span
                                            class="floating-stat-unit">%</span></div>
                                </div>
                            </div>
                        </div>

                        <!-- Overall Progress Card -->
                        <div class="goal-card">
                            <div class="goal-header">
                                <span class="goal-title">Overall Attendance</span>
                                <div class="goal-icon"><i class="bi bi-trophy"></i></div>
                            </div>
                            <div class="goal-status">Status: <span id="attendanceStatus">Standard</span></div>
                            <div class="goal-value"><span id="overallAttendance">85</span><span>%</span></div>
                        </div>

                    </div>

                    <!-- Center Column -->
                    <div class="center-column">

                        <!-- Attendance Trend Chart -->
                        <div class="chart-card">
                            <div class="chart-header">
                                <div class="chart-title">
                                    <h3>Attendance Improvement</h3>
                                    <p>This week</p>
                                </div>
                                <select class="time-select" id="chartTimeSelect" onchange="updateDashboardChart()">
                                    <option value="week">Week</option>
                                    <option value="month">Month</option>
                                </select>
                            </div>
                            <div class="chart-content">
                                <canvas id="attendanceChart"></canvas>
                                <div class="chart-badge" id="chartBadge">
                                    80%+ Imp
                                    <span id="chartBadgeDate">Today</span>
                                </div>
                            </div>
                            <div class="chart-days">
                                <span class="chart-day">MON</span>
                                <span class="chart-day">TUE</span>
                                <span class="chart-day">WED</span>
                                <span class="chart-day">THU</span>
                                <span class="chart-day">FRI</span>
                                <span class="chart-day">SAT</span>
                                <span class="chart-day">SUN</span>
                            </div>
                        </div>

                        <!-- Recent Activity / Schedule -->
                        <div class="reports-card">
                            <div class="reports-header">
                                <h3>Today's Schedule</h3>
                                <button class="filter-btn">
                                    <span>Filters</span>
                                    <i class="bi bi-chevron-down"></i>
                                </button>
                            </div>
                            <div id="scheduleList">
                                <!-- Schedule items will be loaded dynamically -->
                                <div class="report-item">
                                    <div class="report-info">
                                        <div class="report-name">Loading schedule...</div>
                                        <div class="report-date">Please wait</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>

                    <!-- Right Column -->
                    <div class="right-column">

                        <!-- Next Class Card -->
                        <div class="session-card">
                            <div class="session-header">
                                <h3>Next Class</h3>
                                <button class="session-link" onclick="navigateToSection('timetable-section')">
                                    <i class="bi bi-arrow-up-right"></i>
                                </button>
                            </div>
                            <div class="session-countdown">
                                <div class="countdown-label">Starts in</div>
                                <div class="countdown-time" id="nextClassCountdown">
                                    <span class="countdown-value" id="countdownHours">0</span>
                                    <span class="countdown-unit">hr</span>
                                    <span class="countdown-value" id="countdownMins">0</span>
                                    <span class="countdown-unit">min</span>
                                </div>
                            </div>
                            <div class="session-faculty" id="nextClassInfo">
                                <img src="https://ui-avatars.com/api/?name=Faculty&background=8B7FD8&color=fff"
                                    alt="Faculty">
                                <div class="session-faculty-info">
                                    <h4 id="nextClassName">No upcoming class</h4>
                                    <p id="nextClassFaculty">-</p>
                                </div>
                            </div>
                        </div>

                        <!-- Subject Performance Card -->
                        <div class="progress-card">
                            <div class="progress-header">
                                <h3>Subject Performance <span class="text-muted">this week</span></h3>
                                <span class="progress-percentage" id="avgPerformance">76%</span>
                            </div>
                            <div class="progress-items" id="subjectProgressList">
                                <div class="progress-item">
                                    <span class="progress-label">Mathematics</span>
                                    <div class="progress-bar-container">
                                        <div class="progress-fill" style="width: 50%"></div>
                                    </div>
                                    <span class="progress-value">50%</span>
                                </div>
                                <div class="progress-item">
                                    <span class="progress-label">Physics</span>
                                    <div class="progress-bar-container">
                                        <div class="progress-fill purple-fill" style="width: 85%"></div>
                                    </div>
                                    <span class="progress-value">85%</span>
                                </div>
                                <div class="progress-item">
                                    <span class="progress-label">Chemistry</span>
                                    <div class="progress-bar-container">
                                        <div class="progress-fill success-fill" style="width: 60%"></div>
                                    </div>
                                    <span class="progress-value">60%</span>
                                </div>
                            </div>
                        </div>

                        <!-- Low Subjects Card -->
                        <div class="stat-card">
                            <div class="stat-header">
                                <span class="stat-label">Low Subjects</span>
                                <div class="stat-icon danger">
                                    <i class="bi bi-exclamation-circle"></i>
                                </div>
                            </div>
                            <div class="stat-value" id="lowSubjectsCount">0</div>
                            <div class="stat-description">Below 75% attendance</div>
                        </div>

                    </div>

                </div>

                <!-- Recent Activity Section -->
                <div class="content-card mt-4">
                    <h5><i class="bi bi-activity me-2"></i>Recent Activity</h5>
                    <div class="activity-list" id="activityFeed">
                        <div class="activity-item">
                            <div class="activity-icon success">
                                <i class="bi bi-check-lg"></i>
                            </div>
                            <div class="activity-details">
                                <div class="activity-title">Attendance marked for Mathematics</div>
                                <div class="activity-time">2 hours ago</div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

            <!-- Timetable Section -->
            <div id="timetable-section" class="page-section">
                <div class="greeting-section">
                    <h1 class="greeting-title"><i class="bi bi-calendar-week me-3"></i>Class Timetable</h1>
                    <p class="greeting-subtitle">Your weekly schedule at a glance</p>
                </div>

                <div class="content-card">
                    <!-- Mobile Day Pills -->
                    <ul class="nav nav-pills mb-4 d-lg-none gap-2 flex-wrap" id="pills-tab" role="tablist">
                        <li class="nav-item"><button class="nav-link active" data-bs-toggle="pill"
                                data-bs-target="#tab-mon">Mon</button></li>
                        <li class="nav-item"><button class="nav-link" data-bs-toggle="pill"
                                data-bs-target="#tab-tue">Tue</button></li>
                        <li class="nav-item"><button class="nav-link" data-bs-toggle="pill"
                                data-bs-target="#tab-wed">Wed</button></li>
                        <li class="nav-item"><button class="nav-link" data-bs-toggle="pill"
                                data-bs-target="#tab-thu">Thu</button></li>
                        <li class="nav-item"><button class="nav-link" data-bs-toggle="pill"
                                data-bs-target="#tab-fri">Fri</button></li>
                        <li class="nav-item"><button class="nav-link" data-bs-toggle="pill"
                                data-bs-target="#tab-sat">Sat</button></li>
                    </ul>

                    <!-- Desktop Calendar Table View -->
                    <div class="d-none d-lg-block" id="timetableGrid">
                        <!-- Will be populated dynamically with calendar table -->
                    </div>

                    <!-- Mobile Tabs -->
                    <div class="d-lg-none tab-content" id="timetableMobileTabs">
                        <!-- Will be populated dynamically -->
                    </div>
                </div>
            </div>

            <!-- Reports Section -->
            <div id="reports-section" class="page-section">
                <div class="greeting-section">
                    <h1 class="greeting-title"><i class="bi bi-bar-chart-line me-3"></i>Attendance Analytics</h1>
                    <p class="greeting-subtitle">Track your attendance performance</p>
                </div>

                <div class="content-card mb-4">
                    <div class="d-flex flex-wrap justify-content-between align-items-center gap-3">
                        <h5 class="mb-0 fw-bold">Performance Overview</h5>
                        <div class="report-filters">
                            <button class="report-filter-btn active"
                                onclick="updateReport('weekly', this)">Weekly</button>
                            <button class="report-filter-btn" onclick="updateReport('monthly', this)">Monthly</button>
                            <button class="report-filter-btn" onclick="updateReport('overall', this)">Overall</button>
                        </div>
                    </div>
                </div>

                <div class="row g-4 mb-4">
                    <div class="col-lg-8">
                        <div class="content-card h-100">
                            <canvas id="trendChart" height="200"></canvas>
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <div class="content-card h-100">
                            <canvas id="subjectChart" height="280"></canvas>
                        </div>
                    </div>
                </div>

                <div class="content-card">
                    <h6 class="fw-bold mb-3"><i class="bi bi-table me-2"></i>Detailed Subject Report</h6>
                    <div class="table-responsive">
                        <table class="table table-hover align-middle mb-0">
                            <thead>
                                <tr>
                                    <th>Subject Name</th>
                                    <th>Total Classes</th>
                                    <th>Attended</th>
                                    <th>Absent</th>
                                    <th>Attendance %</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="reportTableBody">
                                <!-- Will be populated dynamically -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Notices Section -->
            <div id="notices-section" class="page-section">
                <div class="greeting-section">
                    <h1 class="greeting-title"><i class="bi bi-megaphone me-3"></i>Notice Board</h1>
                    <p class="greeting-subtitle">Stay updated with important announcements</p>
                </div>

                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        <div class="content-card">
                            <div class="d-flex justify-content-between align-items-center mb-4">
                                <h5 class="fw-bold mb-0">Recent Notices</h5>
                                <button class="filter-btn">
                                    <i class="bi bi-funnel me-1"></i> Filter
                                </button>
                            </div>
                            <div id="noticesContainer">
                                <!-- Notices will be loaded dynamically -->
                                <div class="text-center py-4 text-muted">
                                    <i class="bi bi-hourglass-split fs-2 d-block mb-2"></i>
                                    Loading notices...
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Profile Section -->
            <div id="profile-section" class="page-section">
                <div class="greeting-section">
                    <h1 class="greeting-title"><i class="bi bi-person-circle me-3"></i>My Profile</h1>
                    <p class="greeting-subtitle">Manage your account settings</p>
                </div>

                <div class="row g-4">
                    <div class="col-lg-7">
                        <div class="profile-header-card">
                            <img id="profilePhoto"
                                src="https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?auto=format&fit=crop&w=400&q=80"
                                alt="Profile" class="profile-avatar-large" style="cursor: pointer;"
                                title="Click to change profile picture">
                            <h2 class="profile-name" id="pfName">Student Name</h2>
                            <p class="profile-subtitle" id="pfCourse">BE - CSE â€¢ 3rd Sem</p>
                            <button class="profile-edit-btn btn-edit-profile" id="editProfileBtn">
                                <i class="bi bi-pencil-square me-2"></i>Edit Profile
                            </button>

                            <div class="profile-info-grid">
                                <div class="profile-info-item">
                                    <div class="profile-info-label">Date of Birth</div>
                                    <div class="profile-info-value" id="pfDOB">-</div>
                                </div>
                                <div class="profile-info-item">
                                    <div class="profile-info-label">Gender</div>
                                    <div class="profile-info-value" id="pfGender">-</div>
                                </div>
                                <div class="profile-info-item">
                                    <div class="profile-info-label">Blood Group</div>
                                    <div class="profile-info-value" id="pfBlood">-</div>
                                </div>
                            </div>
                        </div>

                        <div class="content-card">
                            <h6 class="fw-bold mb-3"><i class="bi bi-people me-2"></i>Family Information</h6>
                            <div class="row">
                                <div class="col-6">
                                    <small class="text-muted">Father</small>
                                    <div class="fw-semibold" id="pfFather">-</div>
                                </div>
                                <div class="col-6">
                                    <small class="text-muted">Mother</small>
                                    <div class="fw-semibold" id="pfMother">-</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-5">
                        <div class="content-card">
                            <h6 class="fw-bold mb-3"><i class="bi bi-mortarboard me-2"></i>Academic Details</h6>
                            <div class="mt-3 small text-muted">Identifiers</div>
                            <div class="row mt-2 g-2">
                                <div class="col-12 d-flex justify-content-between border-bottom pb-2">
                                    <span class="text-muted">Admission No:</span>
                                    <span class="fw-semibold" id="pfAdmission">-</span>
                                </div>
                                <div class="col-12 d-flex justify-content-between border-bottom pb-2">
                                    <span class="text-muted">Roll No:</span>
                                    <span class="fw-semibold" id="pfRoll">-</span>
                                </div>
                                <div class="col-12 d-flex justify-content-between pb-2">
                                    <span class="text-muted">University Reg. ID:</span>
                                    <span class="fw-semibold" id="pfReg">-</span>
                                </div>
                            </div>

                            <hr class="my-4">
                            <div class="small text-muted mb-2">Course Info</div>
                            <div class="row g-2">
                                <div class="col-12 d-flex justify-content-between border-bottom pb-2">
                                    <span class="text-muted">Degree:</span>
                                    <span class="fw-semibold" id="pfDegree">-</span>
                                </div>
                                <div class="col-12 d-flex justify-content-between border-bottom pb-2">
                                    <span class="text-muted">Branch:</span>
                                    <span class="fw-semibold" id="pfBranch">-</span>
                                </div>
                                <div class="col-12 d-flex justify-content-between border-bottom pb-2">
                                    <span class="text-muted">Semester:</span>
                                    <span class="fw-semibold" id="pfSemester">-</span>
                                </div>
                                <div class="col-12 d-flex justify-content-between pb-2">
                                    <span class="text-muted">Batch:</span>
                                    <span class="fw-semibold" id="pfBatch">-</span>
                                </div>
                            </div>
                        </div>

                        <div class="content-card">
                            <h6 class="fw-bold mb-3"><i class="bi bi-gear me-2"></i>Preferences</h6>
                            <div class="d-flex justify-content-between align-items-center p-3 rounded-3"
                                style="background: rgba(232, 228, 249, 0.5);">
                                <div>
                                    <i class="bi bi-moon me-2"></i>
                                    <span class="fw-semibold">Dark Mode</span>
                                </div>
                                <div class="form-check form-switch mb-0">
                                    <input class="form-check-input" type="checkbox" id="darkModeToggle"
                                        style="width: 2.5em; height: 1.25em;" onchange="toggleDarkMode(this)">
                                </div>
                            </div>
                            <div class="d-flex justify-content-between align-items-center p-3 rounded-3 mt-2"
                                style="background: rgba(232, 228, 249, 0.5);">
                                <div>
                                    <i class="bi bi-envelope me-2"></i>
                                    <span class="fw-semibold">Email Notifications</span>
                                </div>
                                <div class="form-check form-switch mb-0">
                                    <input class="form-check-input" type="checkbox" id="emailNotifToggle"
                                        style="width: 2.5em; height: 1.25em;" checked>
                                </div>
                            </div>
                        </div>

                        <!-- Change Password Card -->
                        <div class="content-card">
                            <h6 class="fw-bold mb-3"><i class="bi bi-shield-lock me-2"></i>Security</h6>
                            <div class="d-flex justify-content-between align-items-center p-3 rounded-3"
                                style="background: rgba(232, 228, 249, 0.5);">
                                <div>
                                    <i class="bi bi-key me-2"></i>
                                    <span class="fw-semibold">Change Password</span>
                                    <div class="small text-muted">Update your account password</div>
                                </div>
                                <button class="btn btn-outline-primary btn-sm" onclick="openChangePasswordModal()">
                                    <i class="bi bi-pencil me-1"></i>Change
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="col-12">
                        <div class="content-card">
                            <h6 class="fw-bold mb-3"><i class="bi bi-geo-alt me-2"></i>Contact & Location</h6>
                            <div class="row mt-3 g-4">
                                <div class="col-md-4">
                                    <div class="small text-muted mb-1">College Email</div>
                                    <div class="fw-semibold" id="pfEmailCollege">-</div>
                                    <div class="small text-muted mt-3 mb-1">Personal Email</div>
                                    <div class="fw-semibold" id="pfEmailPersonal">-</div>
                                </div>
                                <div class="col-md-4">
                                    <div class="small text-muted mb-1">Phone</div>
                                    <div class="fw-semibold" id="pfPhone">-</div>
                                </div>
                                <div class="col-md-4">
                                    <div class="small text-muted mb-1">Current Address</div>
                                    <div class="fw-semibold" id="pfAddressCurrent">-</div>
                                </div>
                            </div>
                            <hr class="my-4">
                            <div class="small text-muted mb-1">Permanent Address</div>
                            <div class="fw-semibold" id="pfAddressPermanent">-</div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- Mobile Navigation -->
    <nav class="mobile-nav">
        <div class="mobile-nav-items">
            <a class="mobile-nav-item active" onclick="navigateToSection('dashboard-section', this)"
                data-section="dashboard-section">
                <i class="bi bi-grid-3x3-gap"></i>
                Dashboard
            </a>
            <a class="mobile-nav-item" onclick="navigateToSection('timetable-section', this)"
                data-section="timetable-section">
                <i class="bi bi-calendar3"></i>
                Timetable
            </a>
            <a class="mobile-nav-item" onclick="navigateToSection('reports-section', this)"
                data-section="reports-section">
                <i class="bi bi-bar-chart"></i>
                Reports
            </a>
            <a class="mobile-nav-item" onclick="navigateToSection('notices-section', this)"
                data-section="notices-section">
                <i class="bi bi-megaphone"></i>
                Notices
            </a>
            <a class="mobile-nav-item" onclick="navigateToSection('profile-section', this)"
                data-section="profile-section">
                <i class="bi bi-person"></i>
                Profile
            </a>
        </div>
    </nav>

    <!-- Camera Modal for Attendance -->
    <div class="modal fade" id="cameraModal" tabindex="-1" data-bs-backdrop="static">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="bi bi-camera-video me-2"></i>Attendance Verification</h5>
                    <button type="button" class="btn-close" onclick="closeCamera()"></button>
                </div>
                <div class="modal-body text-center">
                    <p class="text-muted small mb-3">Subject: <span id="modalSubject" class="fw-bold"
                            style="color: var(--primary-purple);"></span></p>
                    <div id="locationStep" class="mb-3 p-3 rounded-3" style="background: rgba(232, 228, 249, 0.5);">
                        <div class="d-flex align-items-center justify-content-center gap-2">
                            <div class="spinner-border spinner-border-sm" style="color: var(--primary-purple);"
                                id="locSpinner"></div>
                            <span id="locStatusText" class="small fw-bold">Verifying Geofence (15m)...</span>
                        </div>
                        <small id="distanceDisplay" class="d-block text-muted mt-2" style="font-size: 0.75rem;"></small>
                    </div>
                    <div id="cameraContainer" style="display: none; position: relative;">
                        <video id="videoElement" autoplay playsinline style="border-radius: 16px; width: 100%;"></video>
                        <div class="position-absolute bottom-0 start-50 translate-middle-x mb-3">
                            <button class="btn rounded-circle shadow-lg"
                                style="width: 56px; height: 56px; background: white;" onclick="takeSnapshot()">
                                <i class="bi bi-camera-fill fs-4" style="color: var(--primary-purple);"></i>
                            </button>
                        </div>
                        <canvas id="canvas" style="display: none;"></canvas>
                        <img id="photo" style="display: none; width: 100%; border-radius: 16px;">
                    </div>
                    <div id="errorMsg" class="alert alert-danger small mt-3 d-none rounded-3"></div>
                </div>
                <div class="modal-footer justify-content-center">
                    <button class="action-btn px-5 py-2" id="submitBtn" disabled onclick="finalizeAttendance()">
                        <i class="bi bi-check-circle me-2"></i>Submit
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container"
        style="position: fixed; top: 20px; right: 20px; z-index: 9999; display: flex; flex-direction: column; gap: 10px;">
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script src="../assets/js/api.js"></script>
    <script src="../assets/js/socket.js"></script>
    <script src="../assets/js/utils.js"></script>
    <script src="../assets/js/student-dashboard.js"></script>
    <script src="../assets/js/chatbot.js"></script>
</body>

</html>

</html>